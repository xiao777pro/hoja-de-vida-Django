{% extends 'base.html' %}
{% load custom_filters %}

{% block title %}{{ page_title }} - Hoja de Vida{% endblock %}

{% block content %}
<div class="container-fluid py-4">
    <div class="row mb-5 text-center">
        <div class="col-12">
            <h1 class="display-5 fw-bold section-title-cur">
                <i class="bi bi-book-fill"></i> Cursos Realizados
            </h1>
            <p class="text-muted">Formación continua, capacitaciones y talleres de especialización.</p>
            <div class="custom-hr-cur mx-auto"></div>
        </div>
    </div>

    {% if cursos %}
    <div class="row g-4">
        {% for curso in cursos %}
        <div class="col-12 mb-5">
            <div class="course-container shadow-sm">
                <div class="row g-0">
                    <div class="col-lg-6 p-4">
                        <div class="cur-info-side">
                            <div class="d-flex justify-content-between align-items-start mb-3">
                                <span class="badge-date-cur">
                                    {{ curso.fechainicio|date:"M Y" }} - {{ curso.fechafin|date:"M Y" }}
                                </span>
                                <span class="text-muted small fw-bold">
                                    <i class="bi bi-clock-history"></i> {{ curso.totalhoras }} Horas
                                </span>
                            </div>
                            
                            <h3 class="cur-title">{{ curso.nombrecurso }}</h3>
                            <h5 class="cur-entity">
                                <i class="bi bi-building-check"></i> {{ curso.entidadpatrocinadora }}
                            </h5>
                            
                            <hr class="soft-hr-cur">
                            
                            <div class="cur-description">
                                <h6><i class="bi bi-info-circle"></i> Resumen del Curso:</h6>
                                <p>{{ curso.descripcioncurso|default:"Sin descripción detallada." }}</p>
                            </div>

                            <div class="cur-contact-info mt-3 p-3 rounded bg-light">
                                <h6 class="small text-uppercase fw-bold text-muted mb-2">Información de contacto:</h6>
                                {% if curso.nombrecontactoauspicia %}
                                    <p class="mb-1 small"><i class="bi bi-person-circle"></i> {{ curso.nombrecontactoauspicia }}</p>
                                {% endif %}
                                {% if curso.telefonocontactoauspicia %}
                                    <p class="mb-1 small"><i class="bi bi-telephone-fill"></i> {{ curso.telefonocontactoauspicia }}</p>
                                {% endif %}
                                {% if curso.emailempresapatrocinadora %}
                                    <p class="mb-0 small"><i class="bi bi-envelope-at-fill"></i> {{ curso.emailempresapatrocinadora }}</p>
                                {% endif %}
                            </div>
                        </div>
                    </div>

                    <div class="col-lg-6 bg-mint-preview p-3 text-center">
                        <div class="pdf-preview-container">
                            {% if curso.rutacertificado %}
                                <div class="ratio ratio-4x3 mb-3 shadow-sm rounded overflow-hidden bg-white">
                                    <iframe src="{{ curso.rutacertificado.url }}" width="100%" height="100%" style="border:none;">
                                    </iframe>
                                </div>
                                
                                <a href="{{ curso.rutacertificado.url }}" target="_blank" class="btn-pdf-new-tab">
                                    <i class="bi bi-file-earmark-pdf-fill"></i> Abrir en una nueva pestaña
                                </a>
                            {% else %}
                                <div class="no-pdf-placeholder">
                                    <i class="bi bi-file-earmark-x" style="font-size: 3rem; color: #ccc;"></i>
                                    <p class="text-muted mt-2">No hay certificado adjunto</p>
                                </div>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <div class="alert alert-mint-pastel text-center mx-auto" style="max-width: 600px;">
        <i class="bi bi-info-circle"></i> No se han registrado cursos todavía.
    </div>
    {% endif %}
</div>
{% endblock %}
